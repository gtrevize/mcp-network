# ============================================
# MCP Network Testing Server Configuration
# ============================================
# IMPORTANT: Copy this file to .env and replace all CHANGEME values
# The server will refuse to start if any CHANGEME values are detected

# ============================================
# Authentication Token (REQUIRED)
# ============================================
# Authentication Token - JWT token with user identity and roles
# Generate with: npm run generate-token <userId> <role>
# Example: npm run generate-token admin admin
# Set this in your environment when running the server or client
AUTH_TOKEN=CHANGEME

# ============================================
# Server Configuration
# ============================================
# Node environment: development | production | test
NODE_ENV=development

# Log level: debug | info | warn | error
LOG_LEVEL=info

# Access log file path (optional)
# ACCESS_LOG_FILE=/var/log/mcp-network/access.log

# ============================================
# API Server Configuration
# ============================================
# REST API server port (default: 3001)
API_PORT=3001

# Enable API server (true/false)
API_ENABLED=true

# REST API URL for client connections (used by mcp-network-cli)
# Format: http://hostname:port or https://hostname:port
# Examples:
#   Local: http://localhost:3001
#   Remote: https://api.example.com
API_URL=http://localhost:3001

# CORS origin (comma-separated list of allowed origins, or * for all)
# Leave empty or set to false for same-origin only (most secure)
# Example: CORS_ORIGIN=https://app.example.com,https://admin.example.com
# Warning: Using * allows any origin and is insecure for production
CORS_ORIGIN=

# API rate limiting (requests per window per IP)
API_RATE_LIMIT_MAX=100
API_RATE_LIMIT_WINDOW_MS=60000

# ============================================
# Network Tools Configuration
# ============================================
# Maximum timeout for network operations (milliseconds)
MAX_TIMEOUT=30000

# Maximum ping count per request
MAX_PING_COUNT=10

# Maximum port scan range
MAX_PORT_SCAN_RANGE=100

# ============================================
# Let's Encrypt Configuration (OPTIONAL)
# ============================================
# The letsencrypt tool is optional - only configure if you need it
# Leave LETSENCRYPT_EMAIL empty or remove it to disable the letsencrypt tool

# Use Let's Encrypt production environment (true/false)
# WARNING: Production has rate limits - use false for testing
LETSENCRYPT_PRODUCTION=false

# Let's Encrypt account email (required only if you want to use the letsencrypt tool)
# Set to empty string to disable: LETSENCRYPT_EMAIL=
# Or provide your email: LETSENCRYPT_EMAIL=your-email@example.com
LETSENCRYPT_EMAIL=

# ============================================
# Rate Limiting
# ============================================
# Enable rate limiting (true/false)
RATE_LIMIT_ENABLED=true

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# Rate limit window in milliseconds
RATE_LIMIT_WINDOW_MS=60000

# ============================================
# Security
# ============================================
# Enable anti-jailbreaking patterns (true/false)
SECURITY_JAILBREAK_DETECTION=true

# Enable input validation (true/false)
SECURITY_INPUT_VALIDATION=true

# Allowed IP addresses (comma-separated, empty = all allowed)
# ALLOWED_IPS=127.0.0.1,::1,192.168.1.0/24

# ============================================
# Tool Permissions (14 Tools)
# ============================================
# Enable/disable specific tools (true/false)
# Note: Built-in tools (dns_lookup, test_*, get_ip_address, ip_geolocation,
#       reverse_dns, letsencrypt) are always available and don't need flags

# Network Connectivity Tools
TOOL_PING_ENABLED=true
TOOL_TRACEROUTE_ENABLED=true
TOOL_TEST_PORT_ENABLED=true

# DNS & IP Tools (always enabled - no external dependencies)
# dns_lookup, get_ip_address, ip_geolocation, reverse_dns

# Domain/IP Information
TOOL_WHOIS_ENABLED=true

# HTTP/API Testing (always enabled)
# test_api, test_tls

# Port Scanning (requires nmap)
TOOL_PORT_SCAN_ENABLED=true

# Packet Capture (requires root/sudo privileges)
TOOL_TCPDUMP_ENABLED=false

# Bandwidth Testing (requires iperf3)
TOOL_IPERF_ENABLED=false

# Certificate Management (always enabled)
# letsencrypt

# ============================================
# IP Address Detection Configuration
# ============================================
# get_ip_address tool detects the server's public IPv4 address
# Primary method: DNS queries (fast, ~80ms)
#   - OpenDNS: resolver1.opendns.com, resolver2.opendns.com
#   - Google DNS: ns1.google.com
# Fallback method: HTTP APIs (slower, ~200-500ms)
#   - api.ipify.org
#   - api4.my-ip.io
#   - icanhazip.com
# No configuration required - works automatically

# ============================================
# IP Geolocation Configuration
# ============================================
# ip_geolocation tool provides location info for IP addresses
# Uses free public APIs with automatic fallback:
# - ip-api.com (primary) - comprehensive data
# - ipapi.co (secondary) - alternative API
# - ipwhois.app (tertiary) - backup service
# - iplocation.net (web scraping fallback)
# No API keys required - fully automatic

# ============================================
# Reverse DNS Configuration
# ============================================
# reverse_dns tool performs PTR record lookups
# Uses system 'dig' command with -x flag
# Returns all hostnames associated with an IP
# No configuration required
